# OpenTrade 日志轮转配置
# 文件: /etc/logrotate.d/opentrade

/root/.opentrade/logs/*.log {
    daily
    rotate 14
    compress
    delaycompress
    dateext
    dateformat -%Y%m%d
    missingok
    notifempty
    create 0640 root root
    
    postrotate
        # 重新打开日志文件
        kill -HUP $(cat /root/.opentrade/logs/opentrade.pid 2>/dev/null) 2>/dev/null || true
    endscript
}

/root/.opentrade/logs/*.json {
    daily
    rotate 7
    compress
    delaycompress
    dateext
    dateformat -%Y%m%d
    missingok
    notifempty
    create 0640 root root
}

/var/log/opentrade/*.log {
    daily
    rotate 30
    compress
    delaycompress
    dateext
    missingok
    notifempty
    create 0640 root root
}

# Docker 日志
/var/lib/docker/containers/*/*-json.log {
    daily
    rotate 7
    compress
    delaycompress
    dateext
    missingok
    notifempty
    create 0640 root root
    postrotate
        docker kill -s HUP 2>/dev/null || true
    endscript
}
